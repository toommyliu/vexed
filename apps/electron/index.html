<style>
	html,
	body {
		height: 100%;
		width: 100%;
		margin: 0;
		overflow: hidden;
	}

	#swf {
		width: 100%;
		height: 100%;
	}

	#progress-container {
		position: fixed;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: black;
		display: flex;
		justify-content: center;
		align-items: center;
	}

	#progress {
		width: 75%;
	}
</style>

<script src="src/renderer/jsapi/Auth.js"></script>
<script src="src/renderer/jsapi/Bank.js"></script>
<script src="src/renderer/jsapi/Bot.js"></script>
<script src="src/renderer/jsapi/Combat.js"></script>
<script src="src/renderer/jsapi/Drops.js"></script>
<script src="src/renderer/jsapi/Flash.js"></script>
<script src="src/renderer/jsapi/House.js"></script>
<script src="src/renderer/jsapi/Inventory.js"></script>
<script src="src/renderer/jsapi/Packet.js"></script>
<script src="src/renderer/jsapi/Player.js"></script>
<script src="src/renderer/jsapi/Settings.js"></script>
<script src="src/renderer/jsapi/TempInventory.js"></script>
<script src="src/renderer/jsapi/World.js"></script>

<script src="src/renderer/flash-ipc.js"></script>
<script src="src/renderer/ipc.js"></script>

<script>
	window.addEventListener('DOMContentLoaded', () => {
		var script = document.createElement('script');
		script.textContent = `
			var bot=Bot.getInstance();
			var auth=bot.auth;
			var bank=bot.bank;
			var combat=bot.combat;
			var drops=bot.drops;
			var flash=bot.flash;
			var house=bot.house;
			var inventory=bot.inventory;
			var packets=bot.packets;
			var player=bot.player;
			var settings=bot.settings;
			var tempInventory=bot.tempInventory;
			var world=bot.world;
		`;
		document.body.appendChild(script);
	});
</script>

<script>
	var { ipcRenderer } = require('electron');
	window.addEventListener('keydown', (event) => {
		switch (event.key) {
			// Allow the game to be closed whilst the game is focused
			case 'q': {
				if (event.metaKey) {
					// ipcRenderer.invoke("gameQuit");
				}
				break;
			}
			case 'PageUp':
				ipcRenderer.invoke("loadScript");
				break;
		}
	});
	window.addEventListener('DOMContentLoaded', () => {
		var div = document.createElement('div');
		div.id = 'progress-container';
		document.body.appendChild(div);

		var progress = document.createElement('progress');
		progress.id = 'progress';
		progress.max = "100";
		progress.value = "0";
		document.getElementById('progress-container').appendChild(progress);
	});

	function progress([percentage]) {
		var progress = document.getElementById('progress');
		progress.value = percentage.toString();

		if (percentage === 100) {
			var progressContainer = document.getElementById('progress-container');
			progress?.remove();
			progressContainer?.remove();

			var script = document.createElement('script');
			script.src = 'src/renderer/ipc.js';
			document.body.appendChild(script);
		}
	}
</script>

<embed id="swf" src="grimoire.swf" type="application/x-shockwave-flash" allowScriptAccess="always"
	quality="low"></embed>